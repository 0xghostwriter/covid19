---
layout: "page.njk"
title: "Search"
meta: "Search the Covid19 website."
author: "State of California"
publishdate: "2020-03-23T22:00:00Z"
addtositemap: true
---
<style>
   .aside { 
       position: relative!important;
 }



#answersNow ul {
	list-style: none;
  padding: 0px;
}
#answersNow li {
	border: solid 1px;
	padding: 10px;
	margin-bottom: 10px;
}
#answersNow li:hover .question-link {
	text-decoration: underline;
}
#answersNow .question-link {
	font-weight: bold;
	font-size: 1.2em;
}
#answersNow .answer-details {
	display: none;
	margin-top: 20px;
}
#answersNow li.selected .answer-details {
	display: block;
}
</style>

<h2>Search this website</h2>
<label id="SearchInput" for="q">Enter your search text</label>
<!--<form action="/Search/" class="form-inline">

  <input type="text" class="form-control col-md-6" id="q" name="q" aria-labelledby="SearchInput" autofocus />
	<button type="submit"  class="btn btn-primary">Search</button>	  
</form>-->

<div class="gcse-search" enableAutoComplete="true"></div>



<script>
// use search callback to modify url with history.pushState(null,null,current location?q=searchvalue)
// and also execute below
/*
const urlParam = function (name) {
	var results = new RegExp('[\?&]' + name + '=([^&#]*)')
		.exec(window.location.search);

	return (results !== null) ? results[1] || 0 : false;
}
const urlq = urlParam('q')||'';
const query = decodeURIComponent(urlq.replace(/\+/g,' '));
document.querySelector('input[name=q]').value = query;
*/
</script>
<!--
<gcse:searchresults-only></gcse:searchresults-only>
-->
<script>
	const cx = '003358532045999200914:uxxka6d3pge';
	const gcse = document.createElement('script');
	gcse.type = 'text/javascript';
	gcse.async = true;
	gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
	const s = document.getElementsByTagName('script');
	s[s.length - 1].parentNode.insertBefore(gcse, s[s.length - 1]);


	const myWebSearchStartingCallback = (gname, query) => {
		console.log(gname);
		console.log(query)
		fetch(`https://fa-go-alph-covidqna-001.azurewebsites.net/api/CovidAnswer?q=${query}&name=123`)
		.then(response => response.json())
		.then(data => {
			let answers = [...data[0].answers, ...data[1].answers];
			let html = `<h4>Related questions</h4>
				<ul>${answers.map(function(a) {
					if(a.questions.length > 0) {
						return `<li>
									<a class="question-link">${a.questions[0]}</a>
									<div class="answer-details">
										<p>${a.answer}</p>
										<p>more info: <a href="${a.source}">${a.source}</a></p>
										<p>confidence: ${a.score}</p>
									</div>
								</li>`;
					} else {
						return '';
					}
			}).join('	')}</ul>`
			document.querySelector(".gsc-search-box.gsc-search-box-tools").insertAdjacentHTML('afterend','<div id="answersNow"></div>');
			document.querySelector('#answersNow').innerHTML = html;
			document.querySelector('#answersNow').querySelectorAll('.question-link').forEach(function(a) {
				a.addEventListener('click',function(event) {
					event.preventDefault();
					this.parentNode.classList.toggle('selected')
				})
			})
		});
	}
	window.myImageSearchStartingCallbackName = myWebSearchStartingCallback;

	window.__gcse || (window.__gcse = {});
    window.__gcse.searchCallbacks = {
      web: {
        starting: myWebSearchStartingCallback,
      },
    };
</script> 


<script>
	/*

	they aren't real accordions yet, just divs I will make them into accordions
9:30
and I'll restyle that search input to what it was before and reapply some of the results CSS that got overriden



	//----- Removing some styling attributes after load
setTimeout(function(){
document.getElementsByTagName("TABLE")[0].removeAttribute("cellspacing");
document.getElementsByTagName("TABLE")[0].removeAttribute("cellpadding");
document.getElementById("gs_id50").removeAttribute("cellpadding"); 
document.getElementById("gs_id50").removeAttribute("cellspacing"); 
document.getElementsByClassName("gstl_50 gssb_c").removeAttribute("cellpadding"); 
document.getElementsByClassName("gstl_50 gssb_c").removeAttribute("cellspacing"); 
			  
}, 2000);
*/
</script> 